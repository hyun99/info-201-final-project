if(input$dt2r) {
asthma_data %>%
filter(County == input$state2_choice)
}
)
### CREATING THE FIRE MAP OF 2005 ###
output$fire_map_2005 <- renderPlot({
options(scipen = 999)
ca_fire <- read.csv(file = "ca_fire.csv", stringsAsFactors = FALSE)
fire <- ca_fire %>%
select(FIRE_NAME, FIRE_YEAR, FIRE_SIZE, FIRE_SIZE_CLASS, STATE, COUNTY, FIPS_CODE, FIPS_NAME, "LOCATION" = SOURCE_REPORTING_UNIT_NAME)
by_county <- fire %>%
group_by(FIPS_NAME, FIRE_YEAR) %>%
count(sort = T) # %>%
# ungroup()
by_county <- na.omit(by_county)
by_county <- subset(by_county, FIRE_YEAR == "2005")
# map("county", regions=by_county$FIPS_NAME)
states <- map_data("state")
ca_df <- subset(states, region == "california")
head(ca_df)
counties <- map_data("county")
ca_county <- subset(counties, region == "california")
head(ca_county)
ca_base <- ggplot(data = ca_df, mapping = aes(x = long, y = lat, group = group)) +
coord_fixed(1.3) +
geom_polygon(color = "black", fill = "gray")
ca_base + theme_nothing()
ca_base + theme_nothing() +
geom_polygon(data = ca_county, fill = NA, color = "white") +
geom_polygon(color = "black", fill = NA)
by_county$FIPS_NAME <- tolower(by_county$FIPS_NAME)
names(by_county)[names(by_county) == "FIPS_NAME"] <- "subregion"
by_county
cacopa <- inner_join(ca_county, by_county, by = "subregion")
names(cacopa)[names(cacopa) == "n"] <- "Firerate"
ditch_the_axes <- theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank()
)
fire_map_2005 <- ca_base +
geom_polygon(data = cacopa, aes(fill = Firerate), color = "white") +
geom_polygon(color = "black", fill = NA) +
theme_bw() +
ditch_the_axes +
labs(title = "2005 California Wildfires")
fire_map_2005 + scale_fill_gradient(trans = "log10")
fire_map_2005 <- fire_map_2005 +
scale_fill_gradient(low = "red", high = "darkred")
print(fire_map_2005)
})
### CREATING THE FIRE MAP OF 2010 ###
output$fire_map_2010 <- renderPlot({
options(scipen = 999)
ca_fire <- read.csv(file = "ca_fire.csv", stringsAsFactors = FALSE)
fire <- ca_fire %>%
select(FIRE_NAME, FIRE_YEAR, FIRE_SIZE, FIRE_SIZE_CLASS, STATE, COUNTY, FIPS_CODE, FIPS_NAME, "LOCATION" = SOURCE_REPORTING_UNIT_NAME)
by_county <- fire %>%
group_by(FIPS_NAME, FIRE_YEAR) %>%
count(sort = T) # %>%
# ungroup()
by_county <- na.omit(by_county)
by_county <- subset(by_county, FIRE_YEAR == "2010")
states <- map_data("state")
ca_df <- subset(states, region == "california")
head(ca_df)
counties <- map_data("county")
ca_county <- subset(counties, region == "california")
head(ca_county)
ca_base <- ggplot(data = ca_df, mapping = aes(x = long, y = lat, group = group)) +
coord_fixed(1.3) +
geom_polygon(color = "black", fill = "gray")
ca_base + theme_nothing()
ca_base + theme_nothing() +
geom_polygon(data = ca_county, fill = NA, color = "white") +
geom_polygon(color = "black", fill = NA)
by_county$FIPS_NAME <- tolower(by_county$FIPS_NAME)
names(by_county)[names(by_county) == "FIPS_NAME"] <- "subregion"
by_county
cacopa <- inner_join(ca_county, by_county, by = "subregion")
names(cacopa)[names(cacopa) == "n"] <- "Firerate"
ditch_the_axes <- theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank()
)
fire_map_2010 <- ca_base +
geom_polygon(data = cacopa, aes(fill = Firerate), color = "white") +
geom_polygon(color = "black", fill = NA) +
theme_bw() +
ditch_the_axes +
labs(title = "2010 California Wildfires")
fire_map_2010 + scale_fill_gradient(trans = "log10")
fire_map_2010 <- fire_map_2010 +
scale_fill_gradient(low = "red", high = "darkred")
print(fire_map_2010)
})
#### CREATING THE FIRE MAP OF 2015 ###
output$fire_map_2015 <- renderPlot({
options(scipen = 999)
ca_fire <- read.csv(file = "ca_fire.csv", stringsAsFactors = FALSE)
fire <- ca_fire %>%
select(FIRE_NAME, FIRE_YEAR, FIRE_SIZE, FIRE_SIZE_CLASS, STATE, COUNTY, FIPS_CODE, FIPS_NAME, "LOCATION" = SOURCE_REPORTING_UNIT_NAME)
by_county <- fire %>%
group_by(FIPS_NAME, FIRE_YEAR) %>%
count(sort = T) # %>%
# ungroup()
by_county <- na.omit(by_county)
by_county <- subset(by_county, FIRE_YEAR == "2015")
states <- map_data("state")
ca_df <- subset(states, region == "california")
head(ca_df)
counties <- map_data("county")
ca_county <- subset(counties, region == "california")
head(ca_county)
ca_base <- ggplot(data = ca_df, mapping = aes(x = long, y = lat, group = group)) +
coord_fixed(1.3) +
geom_polygon(color = "black", fill = "gray")
ca_base + theme_nothing()
ca_base + theme_nothing() +
geom_polygon(data = ca_county, fill = NA, color = "white") +
geom_polygon(color = "black", fill = NA)
by_county$FIPS_NAME <- tolower(by_county$FIPS_NAME)
names(by_county)[names(by_county) == "FIPS_NAME"] <- "subregion"
by_county
cacopa <- inner_join(ca_county, by_county, by = "subregion")
names(cacopa)[names(cacopa) == "n"] <- "Firerate"
ditch_the_axes <- theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank()
)
fire_map_2015 <- ca_base +
geom_polygon(data = cacopa, aes(fill = Firerate), color = "white") +
geom_polygon(color = "black", fill = NA) +
theme_bw() +
ditch_the_axes +
labs(title = "2015 California Wildfires")
fire_map_2015 + scale_fill_gradient(trans = "log10")
fire_map_2015 <- fire_map_2015 +
scale_fill_gradient(low = "red", high = "darkred")
print(fire_map_2015)
})
### CREATING THE an INTERACTIVE MAP OF THE WILD FIRES###
output$fire_interactive_map <- renderLeaflet({
pal <- colorFactor(c("navy", "red", "green"),
domain = unique(cacopa$subregion)
)
leaflet(cacopa) %>%
addTiles() %>%
addCircleMarkers(
color = ~ pal(subregion),
stroke = FALSE, fillOpacity = 0.5,
lng = ~long, lat = ~lat,
label = ~ as.character(paste(
subregion,
", Year of the Fire:", FIRE_YEAR,
" , Rate of Fire:", Firerate
))
)
})
}
## Creating the IO
shinyApp(final_ui, final_server)
library(shiny)
library(dplyr)
library(ggplot2)
library(lubridate)
library(tidyr)
library(ggmap)
library(knitr)
library(leaflet)
library(usmap)
library(maps)
library(mapproj)
library(shinydashboard)
asthma_data <- read.csv(file = file.path("asthma_by_county.csv"), stringsAsFactors = F)
asthma_data <- asthma_data %>%
select(Year, Age.Group, Number.of.Visits, County) %>%
arrange(Year, County) %>%
mutate(test <- replace_na(Number.of.Visits, 0)) %>%
group_by(Year, County) %>%
select(-Number.of.Visits) %>%
rename("num_visits" = `test <- replace_na(Number.of.Visits, 0)`) %>%
summarise(sum_visits = sum(num_visits)) %>%
filter(
Year == 2012 | Year == 2013 | Year == 2014 | Year == 2015 | Year == 2016
)
years <- unique(asthma_data$Year)
county_names <- unique(asthma_data$County)
## CREATING THE DASHBOARD SIDEBAR
sidebar <- dashboardSidebar(
sidebarMenu(
menuItem("Test", tabName = "Test", icon = icon("dashboard"))
)
)
# CREATING EACH INDIVIDUAL TAB's BODY
body <- dashboardBody(
tabItems(
tabItem(tabName = "Asthma",
h2("Asthma Patients in California Counties from 2012 - 2016"),
selectInput(
"state1_choice",
"Select 1st County to Observe",
choices = county_names
),
checkboxInput(
"dt1r",
"See Table",
value = F
),
selectInput(
"state2_choice",
"Select 1st County to Observe",
choices = county_names
),
checkboxInput(
"dt2r",
"See Table",
value = F
),
#I'm hopefully going to eventually have a button to merge the two plots
# checkboxInput(
#   "merge",
#   strong("Join the Plots"),
#   value = F
# ),
tableOutput("ct1"),
tableOutput("ct2"),
fluidRow(
plotOutput("county1"),
plotOutput("county2")
)
),
### CREATING SECOND TAB ###
tabItem(tabName = "WildFires",
h2("Severity of WildFires in California Counties for Every 5 Years
Since 2005"),
fluidRow(
splitLayout(
cellWidths = c("40%", "40%", "40%"),
plotOutput("fire_map_2005"),
plotOutput("fire_map_2010"),
plotOutput("fire_map_2015")
)
),
leafletOutput("fire_interactive_map")
)
)
)
# CREATING MAIN UI
final_ui <- dashboardPage(
dashboardHeader(title = "Asthma"),
sidebar,
body
)
runApp('Final_server.R')
library(shiny)
library(ggplot2)
library(dplyr)
library(lintr)
library(styler)
library(ggimage)
library(plotly)
### READING IN THE NECESSARY STUFF FOR THE SECOND TAB ###
ca_fire <- read.csv(file = file.path("ca_fire.csv"), stringsAsFactors = FALSE)
fire <- ca_fire %>%
select(FIRE_NAME, FIRE_YEAR, FIRE_SIZE, FIRE_SIZE_CLASS, STATE, COUNTY, FIPS_CODE, FIPS_NAME, "LOCATION" = SOURCE_REPORTING_UNIT_NAME)
by_county <- fire %>%
group_by(FIPS_NAME, FIRE_YEAR) %>%
count(sort = T) # %>%
# ungroup()
by_county <- na.omit(by_county)
# map("county", regions=by_county$FIPS_NAME)
states <- map_data("state")
ca_df <- subset(states, region == "california")
#head(ca_df)
counties <- map_data("county")
ca_county <- subset(counties, region == "california")
#head(ca_county)
ca_base <- ggplot(data = ca_df, mapping = aes(x = long, y = lat, group = group)) +
coord_fixed(1.3) +
geom_polygon(color = "black", fill = "gray")
ca_base + theme_nothing()
ca_base + theme_nothing() +
geom_polygon(data = ca_county, fill = NA, color = "white") +
geom_polygon(color = "black", fill = NA)
by_county$FIPS_NAME <- tolower(by_county$FIPS_NAME)
names(by_county)[names(by_county) == "FIPS_NAME"] <- "subregion"
#by_county
cacopa <- inner_join(ca_county, by_county, by = "subregion")
names(cacopa)[names(cacopa) == "n"] <- "Firerate"
### CREATING THE ACTUAL INTERFACE ###
final_server <- function(input, output) {
## FIRST TAB, PLOT OF THE FIRST COUNTY VISUAL
output$county1 <- renderPlot({
data1 <- asthma_data %>%
filter(County == input$state1_choice)
ggplot(data = data1, aes(x = data1$Year, y = data1$sum_visits)) +
geom_image(image = "inhaler2.png", size = .075) +
geom_smooth() +
labs(x = "Year",
y = "Asthma Emergency Department Visits per Year",
title = input$state1_choice)
})
## FIRST TAB, PLOT OF THE SECOND COUNTY VISUAL
output$county2 <- renderPlot({
data2 <- asthma_data %>%
filter(County == input$state2_choice)
#asthma_data$Year == #input$year_choice
ggplot(data = data2, aes(x = data2$Year, y = data2$sum_visits)) +
geom_image(image = "inhaler2.png", size = .075) +
geom_smooth() +
labs(x = "Year",
y = "Asthma Emergency Department Visits per Year",
title = input$state2_choice)
})
## Table to FIRST County Population's Total Hospital Visits in
## the given years
output$ct1 <- renderTable(
if(input$dt1r) {
asthma_data %>%
filter(County == input$state1_choice)
}
)
## Table to Second County Population's Total Hospital Visits in
## the given years
output$ct2 <- renderTable(
if(input$dt2r) {
asthma_data %>%
filter(County == input$state2_choice)
}
)
### CREATING THE FIRE MAP OF 2005 ###
output$fire_map_2005 <- renderPlot({
options(scipen = 999)
ca_fire <- read.csv(file = "ca_fire.csv", stringsAsFactors = FALSE)
fire <- ca_fire %>%
select(FIRE_NAME, FIRE_YEAR, FIRE_SIZE, FIRE_SIZE_CLASS, STATE, COUNTY, FIPS_CODE, FIPS_NAME, "LOCATION" = SOURCE_REPORTING_UNIT_NAME)
by_county <- fire %>%
group_by(FIPS_NAME, FIRE_YEAR) %>%
count(sort = T) # %>%
# ungroup()
by_county <- na.omit(by_county)
by_county <- subset(by_county, FIRE_YEAR == "2005")
# map("county", regions=by_county$FIPS_NAME)
states <- map_data("state")
ca_df <- subset(states, region == "california")
head(ca_df)
counties <- map_data("county")
ca_county <- subset(counties, region == "california")
head(ca_county)
ca_base <- ggplot(data = ca_df, mapping = aes(x = long, y = lat, group = group)) +
coord_fixed(1.3) +
geom_polygon(color = "black", fill = "gray")
ca_base + theme_nothing()
ca_base + theme_nothing() +
geom_polygon(data = ca_county, fill = NA, color = "white") +
geom_polygon(color = "black", fill = NA)
by_county$FIPS_NAME <- tolower(by_county$FIPS_NAME)
names(by_county)[names(by_county) == "FIPS_NAME"] <- "subregion"
by_county
cacopa <- inner_join(ca_county, by_county, by = "subregion")
names(cacopa)[names(cacopa) == "n"] <- "Firerate"
ditch_the_axes <- theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank()
)
fire_map_2005 <- ca_base +
geom_polygon(data = cacopa, aes(fill = Firerate), color = "white") +
geom_polygon(color = "black", fill = NA) +
theme_bw() +
ditch_the_axes +
labs(title = "2005 California Wildfires")
fire_map_2005 + scale_fill_gradient(trans = "log10")
fire_map_2005 <- fire_map_2005 +
scale_fill_gradient(low = "red", high = "darkred")
print(fire_map_2005)
})
### CREATING THE FIRE MAP OF 2010 ###
output$fire_map_2010 <- renderPlot({
options(scipen = 999)
ca_fire <- read.csv(file = "ca_fire.csv", stringsAsFactors = FALSE)
fire <- ca_fire %>%
select(FIRE_NAME, FIRE_YEAR, FIRE_SIZE, FIRE_SIZE_CLASS, STATE, COUNTY, FIPS_CODE, FIPS_NAME, "LOCATION" = SOURCE_REPORTING_UNIT_NAME)
by_county <- fire %>%
group_by(FIPS_NAME, FIRE_YEAR) %>%
count(sort = T) # %>%
# ungroup()
by_county <- na.omit(by_county)
by_county <- subset(by_county, FIRE_YEAR == "2010")
states <- map_data("state")
ca_df <- subset(states, region == "california")
head(ca_df)
counties <- map_data("county")
ca_county <- subset(counties, region == "california")
head(ca_county)
ca_base <- ggplot(data = ca_df, mapping = aes(x = long, y = lat, group = group)) +
coord_fixed(1.3) +
geom_polygon(color = "black", fill = "gray")
ca_base + theme_nothing()
ca_base + theme_nothing() +
geom_polygon(data = ca_county, fill = NA, color = "white") +
geom_polygon(color = "black", fill = NA)
by_county$FIPS_NAME <- tolower(by_county$FIPS_NAME)
names(by_county)[names(by_county) == "FIPS_NAME"] <- "subregion"
by_county
cacopa <- inner_join(ca_county, by_county, by = "subregion")
names(cacopa)[names(cacopa) == "n"] <- "Firerate"
ditch_the_axes <- theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank()
)
fire_map_2010 <- ca_base +
geom_polygon(data = cacopa, aes(fill = Firerate), color = "white") +
geom_polygon(color = "black", fill = NA) +
theme_bw() +
ditch_the_axes +
labs(title = "2010 California Wildfires")
fire_map_2010 + scale_fill_gradient(trans = "log10")
fire_map_2010 <- fire_map_2010 +
scale_fill_gradient(low = "red", high = "darkred")
print(fire_map_2010)
})
#### CREATING THE FIRE MAP OF 2015 ###
output$fire_map_2015 <- renderPlot({
options(scipen = 999)
ca_fire <- read.csv(file = "ca_fire.csv", stringsAsFactors = FALSE)
fire <- ca_fire %>%
select(FIRE_NAME, FIRE_YEAR, FIRE_SIZE, FIRE_SIZE_CLASS, STATE, COUNTY, FIPS_CODE, FIPS_NAME, "LOCATION" = SOURCE_REPORTING_UNIT_NAME)
by_county <- fire %>%
group_by(FIPS_NAME, FIRE_YEAR) %>%
count(sort = T) # %>%
# ungroup()
by_county <- na.omit(by_county)
by_county <- subset(by_county, FIRE_YEAR == "2015")
states <- map_data("state")
ca_df <- subset(states, region == "california")
head(ca_df)
counties <- map_data("county")
ca_county <- subset(counties, region == "california")
head(ca_county)
ca_base <- ggplot(data = ca_df, mapping = aes(x = long, y = lat, group = group)) +
coord_fixed(1.3) +
geom_polygon(color = "black", fill = "gray")
ca_base + theme_nothing()
ca_base + theme_nothing() +
geom_polygon(data = ca_county, fill = NA, color = "white") +
geom_polygon(color = "black", fill = NA)
by_county$FIPS_NAME <- tolower(by_county$FIPS_NAME)
names(by_county)[names(by_county) == "FIPS_NAME"] <- "subregion"
by_county
cacopa <- inner_join(ca_county, by_county, by = "subregion")
names(cacopa)[names(cacopa) == "n"] <- "Firerate"
ditch_the_axes <- theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank()
)
fire_map_2015 <- ca_base +
geom_polygon(data = cacopa, aes(fill = Firerate), color = "white") +
geom_polygon(color = "black", fill = NA) +
theme_bw() +
ditch_the_axes +
labs(title = "2015 California Wildfires")
fire_map_2015 + scale_fill_gradient(trans = "log10")
fire_map_2015 <- fire_map_2015 +
scale_fill_gradient(low = "red", high = "darkred")
print(fire_map_2015)
})
### CREATING THE an INTERACTIVE MAP OF THE WILD FIRES###
output$fire_interactive_map <- renderLeaflet({
pal <- colorFactor(c("navy", "red", "green"),
domain = unique(cacopa$subregion)
)
leaflet(cacopa) %>%
addTiles() %>%
addCircleMarkers(
color = ~ pal(subregion),
stroke = FALSE, fillOpacity = 0.5,
lng = ~long, lat = ~lat,
label = ~ as.character(paste(
subregion,
", Year of the Fire:", FIRE_YEAR,
" , Rate of Fire:", Firerate
))
)
})
}
## Creating the IO
shinyApp(final_ui, final_server)
