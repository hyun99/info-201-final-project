# output$map
# Define UI for application that draws a histogram
ui <- shinyUI(fluidPage(
# Application title
titlePanel("Fire Vis."),
# Sidebar with a slider input for number of bins
sidebarLayout(
sidebarPanel(
selectInput(
inputId = "dataset",
label = "Choose a year:",
choices = c(
by_county$FIRE_YEAR
)
)
),
# Show a plot of the generated distribution
mainPanel(
# TODO
plotOutput("fire_map")
)
)
))
#
# This is the user-interface definition of a Shiny web application. You can
# run the application by clicking 'Run App' above.
#
# Find out more about building applications with Shiny here:
#
#    http://shiny.rstudio.com/
library("shiny")
library("dplyr")
library("ggplot2")
library("lubridate")
library("tidyr")
library("ggmap")
library("knitr")
library("leaflet")
library("usmap")
library(maps)
library("mapproj")
options(scipen = 999)
ca_fire <- read.csv(file = "ca_fire.csv", stringsAsFactors = FALSE)
fire <- ca_fire %>%
select(FIRE_NAME, FIRE_YEAR, FIRE_SIZE, FIRE_SIZE_CLASS, STATE, COUNTY, FIPS_CODE, FIPS_NAME, "LOCATION" = SOURCE_REPORTING_UNIT_NAME)
by_county <- fire %>%
group_by(FIPS_NAME, FIRE_YEAR) %>%
count(sort = T)# %>%
#ungroup()
by_county <- na.omit(by_county)
by_year <- fire %>%
group_by(FIRE_YEAR) %>%
count(sort = T)
#map("county", regions=by_county$FIPS_NAME)
states <- map_data("state")
ca_df <- subset(states, region == "california")
head(ca_df)
counties <- map_data("county")
ca_county <- subset(counties, region == "california")
head(ca_county)
ca_base <- ggplot(data = ca_df, mapping = aes(x = long, y = lat, group = group)) +
coord_fixed(1.3) +
geom_polygon(color = "black", fill = "gray")
ca_base + theme_nothing()
ca_base + theme_nothing() +
geom_polygon(data = ca_county, fill = NA, color = "white") +
geom_polygon(color = "black", fill = NA)
by_county$FIPS_NAME <- tolower(by_county$FIPS_NAME)
names(by_county)[names(by_county) == "FIPS_NAME"] <- "subregion"
by_county
cacopa <- inner_join(ca_county, by_county, by = "subregion")
names(cacopa)[names(cacopa) == "n"] <- "Firerate"
ditch_the_axes <- theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank()
)
fire_map <- ca_base +
geom_polygon(data = cacopa, aes(fill = Firerate), color = "white") +
geom_polygon(color = "black", fill = NA) +
theme_bw() +
ditch_the_axes
fire_map + scale_fill_gradient(trans = "log10")
fire_map <- fire_map +
scale_fill_gradient(low="red", high="darkred")
fire_map
# in ui
#leafletOutput(outputId = "fire_map")
# in server()
# output$map
# Define UI for application that draws a histogram
ui <- shinyUI(fluidPage(
# Application title
titlePanel("Fire Vis."),
# Sidebar with a slider input for number of bins
sidebarLayout(
sidebarPanel(
selectInput(
inputId = "dataset",
label = "Choose a year:",
choices = c(
by_county$FIRE_YEAR
)
)
),
# Show a plot of the generated distribution
mainPanel(
# TODO
plotOutput("fire_map")
)
)
))
#
# This is the server logic of a Shiny web application. You can run the
# application by clicking 'Run App' above.
#
# Find out more about building applications with Shiny here:
#
#    http://shiny.rstudio.com/
#
library(shiny)
server <- (function(input, output) {
# TODO
# Return the requested dataset
datasetInput <- reactive({
switch(input$dataset,
by_county$FIRE_YEAR
)
})
output$fire_map <- renderPlot({
by_county <- fire %>%
group_by(FIPS_NAME, FIRE_YEAR) %>%
count(sort = T)# %>%
#ungroup()
by_county <- na.omit(by_county)
#map("county", regions=fire$FIPS_NAME)
states <- map_data("state")
ca_df <- subset(states, region == "california")
head(ca_df)
counties <- map_data("county")
ca_county <- subset(counties, region == "california")
head(ca_county)
ca_base <- ggplot(data = ca_df, mapping = aes(x = long, y = lat, group = group)) +
coord_fixed(1.3) +
geom_polygon(color = "black", fill = "gray")
ca_base + theme_nothing()
ca_base + theme_nothing() +
geom_polygon(data = ca_county, fill = NA, color = "white") +
geom_polygon(color = "black", fill = NA)
by_county$FIPS_NAME <- tolower(by_county$FIPS_NAME)
names(by_county)[names(by_county) == "FIPS_NAME"] <- "subregion"
cacopa <- inner_join(ca_county, by_county, by = "subregion")
names(cacopa)[names(cacopa) == "n"] <- "Firerate"
ditch_the_axes <- theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank()
)
fire_map <- ca_base +
geom_polygon(data = cacopa, aes(fill = Firerate), color = "white") +
geom_polygon(color = "black", fill = NA) +
theme_bw() +
ditch_the_axes
# fire_map + scale_fill_gradient(trans = "log10")
fire_map <- fire_map +
scale_fill_gradient(low="red", high="darkred")
})
})
shinyApp(ui, server)
install.packages("styler")
install.packages("lintr")
library(shiny)
library(ggplot2)
library(dplyr)
library(lintr)
library(styler)
library(tidyr)
asthma_data <- read.csv("../asthma_by_county.csv", stringsAsFactors = F)
asthma_data <- asthma_data %>%
select(Year, Age.Group, Number.of.Visits, County) %>%
arrange(Year, County) %>%
mutate(test <- replace_na(Number.of.Visits, 0)) %>%
group_by(Year, County) %>%
select(-Number.of.Visits) %>%
rename("num_visits" = `test <- replace_na(Number.of.Visits, 0)`) %>%
summarise(sum_visits = sum(num_visits)) %>%
filter(
Year == 2012 | Year == 2013 | Year == 2014 | Year == 2015 | Year == 2016
)
years <- unique(asthma_data$Year)
county_names <- unique(asthma_data$County)
my_ui <- fluidPage(
h1("Test"),
sidebarLayout(
sidebarPanel(
selectInput(
"state1_choice",
"Select 1st County to Observe",
choices = county_names
),
checkboxInput(
"dt1r",
"See Table",
value = F
),
selectInput(
"state2_choice",
"Select 1st County to Observe",
choices = county_names
),
checkboxInput(
"dt2r",
"See Table",
value = F
),
#I'm hopefully going to eventually have a button to merge the two plots
# checkboxInput(
#   "merge",
#   strong("Join the Plots"),
#   value = F
# ),
tableOutput("ct1"),
tableOutput("ct2")
),
mainPanel(
plotOutput("county1"),
plotOutput("county2")
)
)
)
library(shiny)
library(ggplot2)
library(dplyr)
library(lintr)
library(styler)
library(tidyr)
asthma_data <- read.csv("../asthma_by_county.csv", stringsAsFactors = F)
asthma_data <- asthma_data %>%
select(Year, Age.Group, Number.of.Visits, County) %>%
arrange(Year, County) %>%
mutate(test <- replace_na(Number.of.Visits, 0)) %>%
group_by(Year, County) %>%
select(-Number.of.Visits) %>%
rename("num_visits" = `test <- replace_na(Number.of.Visits, 0)`) %>%
summarise(sum_visits = sum(num_visits)) %>%
filter(
Year == 2012 | Year == 2013 | Year == 2014 | Year == 2015 | Year == 2016
)
years <- unique(asthma_data$Year)
county_names <- unique(asthma_data$County)
my_ui <- fluidPage(
h1("Test"),
sidebarLayout(
sidebarPanel(
selectInput(
"state1_choice",
"Select 1st County to Observe",
choices = county_names
),
checkboxInput(
"dt1r",
"See Table",
value = F
),
selectInput(
"state2_choice",
"Select 1st County to Observe",
choices = county_names
),
checkboxInput(
"dt2r",
"See Table",
value = F
),
#I'm hopefully going to eventually have a button to merge the two plots
# checkboxInput(
#   "merge",
#   strong("Join the Plots"),
#   value = F
# ),
tableOutput("ct1"),
tableOutput("ct2")
),
mainPanel(
plotOutput("county1"),
plotOutput("county2")
)
)
)
View(asthma_data)
asthma_data <- read.csv("../asthma_by_county.csv", stringsAsFactors = F)
asthma_data <- asthma_data %>%
select(Year, Age.Group, Number.of.Visits, County) %>%
arrange(Year, County) %>%
mutate(test <- replace_na(Number.of.Visits, 0)) %>%
group_by(Year, County) %>%
select(-Number.of.Visits) %>%
rename("num_visits" = `test <- replace_na(Number.of.Visits, 0)`) %>%
summarise(sum_visits = sum(num_visits)) %>%
filter(
Year == 2012 | Year == 2013 | Year == 2014 | Year == 2015 | Year == 2016
)
years <- unique(asthma_data$Year)
county_names <- unique(asthma_data$County)
setwd("~/Info 201/info-201-final-project/weathervis/anthony_app")
library(shiny)
library(ggplot2)
library(dplyr)
library(lintr)
library(styler)
library(tidyr)
asthma_data <- read.csv("../asthma_by_county.csv", stringsAsFactors = F)
asthma_data <- asthma_data %>%
select(Year, Age.Group, Number.of.Visits, County) %>%
arrange(Year, County) %>%
mutate(test <- replace_na(Number.of.Visits, 0)) %>%
group_by(Year, County) %>%
select(-Number.of.Visits) %>%
rename("num_visits" = `test <- replace_na(Number.of.Visits, 0)`) %>%
summarise(sum_visits = sum(num_visits)) %>%
filter(
Year == 2012 | Year == 2013 | Year == 2014 | Year == 2015 | Year == 2016
)
years <- unique(asthma_data$Year)
county_names <- unique(asthma_data$County)
my_ui <- fluidPage(
h1("Test"),
sidebarLayout(
sidebarPanel(
selectInput(
"state1_choice",
"Select 1st County to Observe",
choices = county_names
),
checkboxInput(
"dt1r",
"See Table",
value = F
),
selectInput(
"state2_choice",
"Select 1st County to Observe",
choices = county_names
),
checkboxInput(
"dt2r",
"See Table",
value = F
),
#I'm hopefully going to eventually have a button to merge the two plots
# checkboxInput(
#   "merge",
#   strong("Join the Plots"),
#   value = F
# ),
tableOutput("ct1"),
tableOutput("ct2")
),
mainPanel(
plotOutput("county1"),
plotOutput("county2")
)
)
)
library(shiny)
library(ggplot2)
library(dplyr)
library(lintr)
library(styler)
library(ggimage)
library(plotly)
my_server <- function(input, output) {
#County 1 plot
output$county1 <- renderPlot({
data1 <- asthma_data %>%
filter(County == input$state1_choice)
ggplot(data = data1, aes(x = data1$Year, y = data1$sum_visits)) +
geom_image(image = "inhaler2.png", size = .075) +
geom_smooth() +
labs(x = "Year",
y = "Asthma Emergency Department Visits per Year",
title = input$state1_choice)
})
#County 2 plot
output$county2 <- renderPlot({
data2 <- asthma_data %>%
filter(County == input$state2_choice)
#asthma_data$Year == #input$year_choice
ggplot(data = data2, aes(x = data2$Year, y = data2$sum_visits)) +
geom_image(image = "inhaler2.png", size = .075) +
geom_smooth() +
labs(x = "Year",
y = "Asthma Emergency Department Visits per Year",
title = input$state2_choice)
})
#Table1
output$ct1 <- renderTable(
if(input$dt1r) {
asthma_data %>%
filter(County == input$state1_choice)
}
)
#Table 2
output$ct2 <- renderTable(
if(input$dt2r) {
asthma_data %>%
filter(County == input$state2_choice)
}
)
}
shinyApp(my_ui, my_server)
library(shiny)
library(ggplot2)
library(dplyr)
library(lintr)
library(styler)
library(ggimage)
library(plotly)
my_server <- function(input, output) {
#County 1 plot
output$county1 <- renderPlot({
data1 <- asthma_data %>%
filter(County == input$state1_choice)
ggplot(data = data1, aes(x = data1$Year, y = data1$sum_visits)) +
geom_image(image = "inhaler2.png", size = .075) +
geom_smooth() +
labs(x = "Year",
y = "Asthma Emergency Department Visits per Year",
title = input$state1_choice)
})
#County 2 plot
output$county2 <- renderPlot({
data2 <- asthma_data %>%
filter(County == input$state2_choice)
#asthma_data$Year == #input$year_choice
ggplot(data = data2, aes(x = data2$Year, y = data2$sum_visits)) +
geom_image(image = "inhaler2.png", size = .075) +
geom_smooth() +
labs(x = "Year",
y = "Asthma Emergency Department Visits per Year",
title = input$state2_choice)
})
#Table1
output$ct1 <- renderTable(
if(input$dt1r) {
asthma_data %>%
filter(County == input$state1_choice)
}
)
#Table 2
output$ct2 <- renderTable(
if(input$dt2r) {
asthma_data %>%
filter(County == input$state2_choice)
}
)
}
shinyApp(my_ui, my_server)
install.packages("ggimage")
library(shiny)
library(ggplot2)
library(dplyr)
library(lintr)
library(styler)
library(ggimage)
library(plotly)
my_server <- function(input, output) {
#County 1 plot
output$county1 <- renderPlot({
data1 <- asthma_data %>%
filter(County == input$state1_choice)
ggplot(data = data1, aes(x = data1$Year, y = data1$sum_visits)) +
geom_image(image = "inhaler2.png", size = .075) +
geom_smooth() +
labs(x = "Year",
y = "Asthma Emergency Department Visits per Year",
title = input$state1_choice)
})
#County 2 plot
output$county2 <- renderPlot({
data2 <- asthma_data %>%
filter(County == input$state2_choice)
#asthma_data$Year == #input$year_choice
ggplot(data = data2, aes(x = data2$Year, y = data2$sum_visits)) +
geom_image(image = "inhaler2.png", size = .075) +
geom_smooth() +
labs(x = "Year",
y = "Asthma Emergency Department Visits per Year",
title = input$state2_choice)
})
#Table1
output$ct1 <- renderTable(
if(input$dt1r) {
asthma_data %>%
filter(County == input$state1_choice)
}
)
#Table 2
output$ct2 <- renderTable(
if(input$dt2r) {
asthma_data %>%
filter(County == input$state2_choice)
}
)
}
shinyApp(my_ui, my_server)
